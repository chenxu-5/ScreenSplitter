# 屏幕分屏软件项目结构

## 项目概述
该项目是一个基于Windows 11的屏幕分屏软件，使用C#和WPF开发，实现屏幕左右/上下两部分分屏效果，支持窗口自动吸附和快捷键操作。

## 技术栈
- **开发语言**：C# 10.0+
- **框架**：.NET 6/7 WPF
- **平台**：Windows 11
- **开发工具**：Visual Studio 2022
- **API**：Windows User32.dll

## 项目文件结构

```
ScreenSplitter/             # 解决方案根目录
├── ScreenSplitter.sln      # 解决方案文件
├── ScreenSplitter/         # 主项目目录
│   ├── ScreenSplitter.csproj  # 项目文件
│   ├── App.xaml            # WPF应用程序入口
│   ├── App.xaml.cs         # 应用程序代码
│   ├── MainWindow.xaml     # 主窗口（可选项，用于配置界面）
│   ├── MainWindow.xaml.cs  # 主窗口代码
│   ├── Properties/         # 项目属性
│   │   ├── AssemblyInfo.cs
│   │   ├── Resources.Designer.cs
│   │   ├── Resources.resx
│   │   ├── Settings.Designer.cs
│   │   └── Settings.settings
│   ├── Resources/          # 资源文件
│   │   ├── Icons/          # 图标资源
│   │   └── Images/         # 图片资源
│   ├── Core/               # 核心功能模块
│   │   ├── Models/         # 数据模型
│   │   │   ├── SplitType.cs        # 分屏类型枚举
│   │   │   └── SplitConfig.cs      # 分屏配置模型
│   │   ├── Services/       # 核心服务
│   │   │   ├── WindowManager.cs    # 窗口管理服务
│   │   │   ├── ScreenManager.cs    # 屏幕管理服务
│   │   │   ├── HotkeyManager.cs    # 快捷键管理服务
│   │   │   ├── ConfigManager.cs    # 配置管理服务
│   │   │   └── TrayManager.cs      # 系统托盘管理服务
│   │   └── Utils/          # 工具类
│   │       ├── WindowsApi.cs       # Windows API封装
│   │       └── Logger.cs           # 日志工具
│   ├── UI/                 # UI相关代码
│   │   ├── Controls/       # 自定义控件
│   │   └── Windows/        # 窗口
│   │       └── ConfigWindow.xaml.cs # 配置窗口
│   └── App.config          # 应用程序配置文件
├── ScreenSplitter.Tests/   # 测试项目
│   ├── ScreenSplitter.Tests.csproj
│   └── UnitTests/          # 单元测试
│       ├── WindowManagerTests.cs
│       └── ScreenManagerTests.cs
└── README.md               # 项目说明文档
```

## 核心文件说明

### 1. 入口文件
- **App.xaml.cs**：应用程序入口点，负责初始化核心服务和启动应用

### 2. 核心服务
- **WindowManager.cs**：
  - 负责窗口的移动、大小调整
  - 实现窗口自动吸附逻辑
  - 处理窗口的最大化、最小化等状态

- **ScreenManager.cs**：
  - 管理多个显示器信息
  - 计算分屏区域坐标
  - 处理屏幕分辨率变化事件

- **HotkeyManager.cs**：
  - 注册和注销全局快捷键
  - 处理快捷键按下事件
  - 管理用户自定义快捷键配置

- **ConfigManager.cs**：
  - 加载和保存用户配置
  - 管理分屏比例、快捷键设置
  - 处理配置文件的序列化和反序列化

- **TrayManager.cs**：
  - 创建和管理系统托盘图标
  - 处理托盘菜单点击事件
  - 显示通知和提示信息

### 3. 工具类
- **WindowsApi.cs**：
  - 封装Windows User32.dll API
  - 提供窗口操作、系统事件监听等底层功能
  - 定义常量和数据结构

### 4. 数据模型
- **SplitType.cs**：定义分屏类型枚举（左右分屏、上下分屏等）
- **SplitConfig.cs**：存储分屏配置信息，包括分屏类型、比例、快捷键等

## 开发流程

1. **环境搭建**：
   - 安装Visual Studio 2022
   - 安装.NET 6/7 SDK
   - 配置开发环境

2. **项目初始化**：
   - 创建WPF项目
   - 配置项目属性
   - 添加必要的引用

3. **核心功能开发**：
   - 实现Windows API封装
   - 开发窗口管理和屏幕管理功能
   - 实现快捷键注册和处理
   - 添加系统托盘支持

4. **UI开发**：
   - 设计配置界面
   - 添加自定义控件
   - 实现用户交互逻辑

5. **测试**：
   - 编写单元测试
   - 进行功能测试
   - 测试多显示器场景

6. **打包发布**：
   - 配置打包选项
   - 生成安装程序
   - 发布应用程序

## 关键功能实现

### 1. 分屏逻辑
- 根据屏幕尺寸计算分屏区域
- 支持左右和上下分屏
- 支持自定义分屏比例

### 2. 窗口吸附
- 监听窗口移动事件
- 判断窗口是否接近分屏边界
- 自动调整窗口大小和位置

### 3. 快捷键处理
- 注册全局快捷键
- 捕获快捷键消息
- 执行相应的分屏操作

### 4. 配置管理
- 保存用户设置到本地文件
- 支持开机自启动设置
- 支持自定义快捷键

## 扩展功能建议

1. **多显示器支持**：支持在多个显示器上进行分屏操作
2. **自定义分屏布局**：允许用户创建和保存自定义分屏布局
3. **窗口记忆功能**：记住不同应用程序的分屏位置
4. **动画效果**：添加窗口调整时的平滑动画
5. **暗色主题支持**：适配Windows 11的暗色主题
6. **键盘导航**：支持纯键盘操作

## 性能优化建议

1. **减少窗口事件监听频率**：使用防抖技术减少频繁的窗口调整
2. **优化分屏计算**：缓存分屏区域计算结果
3. **合理使用资源**：及时释放不再使用的资源
4. **异步处理**：耗时操作使用异步处理，避免UI卡顿

## 发布与部署

1. **编译选项**：使用Release模式编译，启用代码优化
2. **依赖管理**：使用.NET 6/7的自包含部署，减少依赖问题
3. **签名**：为应用程序添加数字签名，提高安全性
4. **自动更新**：添加自动更新功能，方便用户获取最新版本

## 总结

该项目结构采用分层设计，分离了核心功能和UI层，便于维护和扩展。通过合理的模块划分，可以实现一个功能完整、性能优良的屏幕分屏软件，满足Windows 11用户的分屏需求。